<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>Porting Aria Applications to Legato</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', '02798.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00462.html" target="topic">MPLAB® Harmony Graphics Suite</a> &gt; <a href="02750.html" target="topic">Advanced Topics</a> &gt; <a href="02798.html" target="topic">Porting Aria Applications to Legato</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB® Harmony Graphics Suite</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00462.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="02762.html" target="topic">Previous</a> | <a href="02750.html" target="topic">Up</a> | <a href="02799.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: Porting Aria Applications to Legato Topic Title: Porting Aria Applications to Legato)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table><div class="Element5">
Porting Aria Applications to Legato</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="4465736372697074696F6E"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Microchip Harmony Graphics Suite Legato graphics library is a result of an on going effort to make graphics applications and development more easy to use and high performance..&nbsp;</p>
<p class="Element10">
When porting Aria-related code to Legato library, application developers should be aware that the graphics development infrastructure has undergone considerable changes in Legato.&nbsp;</p>
<p class="Element10">
The table below details items to consider and the impact they have when porting an application using the Aria graphics library to the Legato graphics library.&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element15">
Project Graph Component Changes</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
There are a few changes in MHC that affect the Aria applications. These are:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="24%">
<div class="Element66">
Aria&nbsp;</div></td><td class="Element65" valign="top" width="26%">
<div class="Element66">
Legato&nbsp;</div></td><td class="Element65" valign="top" width="50%">
<div class="Element66">
Discussion&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="24%">
<div class="Element68">
<strong>Aria Graphics Library</strong> component&nbsp;</div></td><td class="Element67" valign="top" width="26%">
<div class="Element68">
<strong>Legato Graphics Library</strong> component&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
The Aria component should be removed from the project graph. Select Legato instead.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="24%">
<div class="Element68">
<strong>Aria Display Driver</strong> components&nbsp;</div></td><td class="Element67" valign="top" width="26%">
<div class="Element68">
<strong>LE Display Driver</strong> components&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
The Aria display driver component should be removed. Select an LE display driver component instead.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="24%">
<div class="Element68">
<strong>GFX Core Hardware Abstraction Layer</strong> component&nbsp;</div></td><td class="Element67" valign="top" width="26%">
<div class="Element68">
<strong>GFX Core LE</strong> component for display management purposes&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
The HAL is no longer needed. The GFX Core LE is enabled on selection of a LE display driver.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<div class="Element15">
Middleware Folder Changes</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
There are a few folder changes which affect Aria applications. These are:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="12%">
<div class="Element66">
Aria&nbsp;</div></td><td class="Element65" valign="top" width="13%">
<div class="Element66">
Legato&nbsp;</div></td><td class="Element65" valign="top" width="75%">
<div class="Element66">
Discussion&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="12%">
<div class="Element68">
middleware/<strong>aria </strong>&nbsp;</div></td><td class="Element67" valign="top" width="13%">
<div class="Element68">
middleware/<strong>legato</strong>&nbsp;</div></td><td class="Element67" valign="top" width="75%">
<div class="Element68">
The aria folder is not used for Legato applications. All related support files will exist in the legato folder. This includes library and drivers and templates.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<div class="Element15">
Generated GFX File Changes</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
There are a few changes which effect the content of generated files. These are:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="21%">
<div class="Element66">
Aria&nbsp;</div></td><td class="Element65" valign="top" width="29%">
<div class="Element66">
Legato&nbsp;</div></td><td class="Element65" valign="top" width="50%">
<div class="Element66">
Discussion&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="21%">
<div class="Element68">
Application specific files are scattered under the config folder in various locations.&nbsp;</div></td><td class="Element67" valign="top" width="29%">
<div class="Element68">
Application specific files are located in the <strong>config/&lt;<i>your config</i>&gt;/gfx/legato/generate</strong>&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
All Legato applications will generate fonts, images, screen and app support files to a single folder named &quot;generate&quot;.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="21%">
<div class="Element68">
The UI design is hidden in the <strong>harmony.prj</strong> file&nbsp;</div></td><td class="Element67" valign="top" width="29%">
<div class="Element68">
The UI design is stored in a single zip file named: <strong>&lt;<i>your_config</i>&gt;_design.zip.</strong>&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
This file is selected when invoking Graphics Designer&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="21%">
<div class="Element68">
<strong>LA</strong> and <strong>la</strong> are used as prefixes&nbsp;</div></td><td class="Element67" valign="top" width="29%">
<div class="Element68">
<strong>LE</strong> and <strong>le</strong> are used as prefixes&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
The prefix LA or la is not used in Legato. Use LE or le prefix items instead.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="21%">
<div class="Element68">
no cache used&nbsp;</div></td><td class="Element67" valign="top" width="29%">
<div class="Element68">
<strong>,legato_generate_cache.zip</strong>&nbsp;</div></td><td class="Element67" valign="top" width="50%">
<div class="Element68">
Faster code generator.<br>Aria generates all files on every generate. Legato will cache previously generated files that have not been modified. Legato only generates files that have been modified or new.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<div class="Element15">
Generated Harmony File Changes</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
There are a few changes to the content of generated files that should be noted. These are:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="22%">
<div class="Element66">
Aria&nbsp;</div></td><td class="Element65" valign="top" width="25%">
<div class="Element66">
Legato&nbsp;</div></td><td class="Element65" valign="top" width="53%">
<div class="Element66">
Discussion&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
In <strong>definitions.h</strong><br>#include &quot;<strong>gfx/hal/gfx.h</strong>&quot;&nbsp;</div></td><td class="Element67" valign="top" width="25%">
<div class="Element68">
#include &quot;<strong>gfx/legato/.generated/le_gen_harmony.h</strong>&quot;&nbsp;</div></td><td class="Element67" valign="top" width="53%">
<div class="Element68">
The Aria HAL is not needed. MHC will generate code to include legato generated harmony files.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
In <strong>initialization.c</strong><br>uses <strong>GFX_Initialize(); </strong> Implicit call to the driver.&nbsp;</div></td><td class="Element67" valign="top" width="25%">
<div class="Element68">
In initializaiton.c<br>uses <strong>DRV_&lt;<i>name</i>&gt;_Initialize(); </strong>Explicit call to the driver.&nbsp;</div></td><td class="Element67" valign="top" width="53%">
<div class="Element68">
An implicit call to the driver is not needed. MHC will generate code to make an explicit driver init call instead.<br><br>For example: <strong>DRV_LCC_Initialize();</strong>&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="22%">
<div class="Element68">
In tasks.c<br><strong>GFX_Update();</strong><br><strong>Aria_Tasks()</strong>&nbsp;</div></td><td class="Element67" valign="top" width="25%">
<div class="Element68">
In task.c<br><strong>DRV_&lt;<i>name</i>&gt;_Update();</strong><br><strong>Legato_Tasks();</strong>&nbsp;</div></td><td class="Element67" valign="top" width="53%">
<div class="Element68">
An implicit call to run the driver and library task machines are not needed. MHC will generate code to make an explicit driver and library task call instead.<br><br>For example: <strong>DRV_LCC_Initialize();</strong>&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<div class="Element15">
Driver Interface Changes</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
There are a few changes which effect Aria driver interface. These are:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="24%">
<div class="Element66">
Aria&nbsp;</div></td><td class="Element65" valign="top" width="32%">
<div class="Element66">
Legato&nbsp;</div></td><td class="Element65" valign="top" width="44%">
<div class="Element66">
Discussion&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="24%">
<div class="Element68">
Implicit driver calls are used through out the library. Leverages the HAL for hardware abstraction.&nbsp;</div></td><td class="Element67" valign="top" width="32%">
<div class="Element68">
Introduces gfx_driver thin abstraction. The library and driver agree upon a common interface. Drivers can be used in a standalone mode.&nbsp;</div></td><td class="Element67" valign="top" width="44%">
<div class="Element68">
Tight coupling of Aria and driver is not needed. Use loose-coupling gfx_driver instead.<br><br>This supports 3rd-Party graphics libraries that want to leverage the harmony device drivers.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="24%">
<div class="Element68">
&nbsp;</div></td><td class="Element67" valign="top" width="32%">
<div class="Element68">
&nbsp;</div></td><td class="Element67" valign="top" width="44%">
<div class="Element68">
&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<div class="Element15">
Widgets and Screen Changes</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
Widgets and screens have a new declaration and calling mechanism. More facilities for speciality in Legato: These are:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="25%">
<div class="Element66">
Aria&nbsp;</div></td><td class="Element65" valign="top" width="27%">
<div class="Element66">
Legato&nbsp;</div></td><td class="Element65" valign="top" width="48%">
<div class="Element66">
Discussion&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="25%">
<div class="Element68">
Widgets have a header with static functions definitions.&nbsp;</div></td><td class="Element67" valign="top" width="27%">
<div class="Element68">
Widgets have a header with extensible virtual function definitions&nbsp;</div></td><td class="Element67" valign="top" width="48%">
<div class="Element68">
Aria's static function implementation is limited. Legato's virtual function notation allows for functionality extensibility without requiring a API change.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="25%">
<div class="Element68">
<a href="02573.html" target="topic">laWidget_SetVisible</a>((<a href="02525.html" target="topic">laWidget</a>*)aButton, LA_FALSE)&nbsp;</div></td><td class="Element67" valign="top" width="27%">
<div class="Element68">
<strong>aButton-&gt;fn-&gt;setVisible</strong>(aButton, LE_FALSE);&nbsp;</div></td><td class="Element67" valign="top" width="48%">
<div class="Element68">
When porting to Legato, note that same functionality is called differently.<br>&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="25%">
<div class="Element68">
str = <a href="02408.html" target="topic">laString_CreateFromID</a>(string_FileNotFound2);<br><a href="01612.html" target="topic">laLabelWidget_SetText</a>(aLabel, str);&nbsp;</div></td><td class="Element67" valign="top" width="27%">
<div class="Element68">
<strong>aLabel-&gt;fn-&gt;setString</strong>(aLabel, (leString*)&amp;ts_FileNotFound1);&nbsp;</div></td><td class="Element67" valign="top" width="48%">
<div class="Element68">
When porting to Legato, note that same functionality is called differently.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="25%">
<div class="Element68">
<a href="02076.html" target="topic">laProgressBarWidget_SetValue</a>(aProgressBar, 0);&nbsp;</div></td><td class="Element67" valign="top" width="27%">
<div class="Element68">
<strong>aProgressBar-&gt;fn-&gt;setValue</strong>(aProgressBar, 0);&nbsp;</div></td><td class="Element67" valign="top" width="48%">
<div class="Element68">
When porting to Legato, note that same functionality is called differently.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="25%">
<div class="Element68">
UI screens are managed by the Aria library,&nbsp;</div></td><td class="Element67" valign="top" width="27%">
<div class="Element68">
UI screens are managed by either Legato library or application.&nbsp;</div></td><td class="Element67" valign="top" width="48%">
<div class="Element68">
UI screens have default Legato library management. Legato provides extensibility by allowing redefinition in the application code.&nbsp;</div></td></tr></table></div></div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
&nbsp;</p>
<div class="Element15">
Memory Use Changes</div>
<p class="Element10">
&nbsp;</p>
<p class="Element10">
Memory use was found to be problematic in Aria during heavy heap usage and debugging. Legato addresses heap allocation and dynamic memory as follows:&nbsp;</p>
<p class="Element10">
&nbsp;</p><div class="Element63">
<div class="TableDiv">
<table cellspacing="0" class="Table2">
<tr>
<td class="Element65" valign="top" width="27%">
<div class="Element66">
Aria&nbsp;</div></td><td class="Element65" valign="top" width="31%">
<div class="Element66">
Legato&nbsp;</div></td><td class="Element65" valign="top" width="41%">
<div class="Element66">
Discussion&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="27%">
<div class="Element68">
Extensive use of heap memory. Dynamic allocation of memory is employed over static allocation.&nbsp;</div></td><td class="Element67" valign="top" width="31%">
<div class="Element68">
Extensive use of staic memory. Static allocation of memory is employed over dynamic allocation.&nbsp;</div></td><td class="Element67" valign="top" width="41%">
<div class="Element68">
Static allocation provides more manageability of memory use, runtime protection and debugging.<br>&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="27%">
<div class="Element68">
Requires a minimum of 4096 bytes.&nbsp;</div></td><td class="Element67" valign="top" width="31%">
<div class="Element68">
Requires a heap space minimum of 512 bytes&nbsp;</div></td><td class="Element67" valign="top" width="41%">
<div class="Element68">
Uses scratch buffers and static library managed memory pools.&nbsp;</div></td></tr><tr>
<td class="Element67" valign="top" width="27%">
<div class="Element68">
Dynamic Widget creation from heap&nbsp;</div></td><td class="Element67" valign="top" width="31%">
<div class="Element68">
Dynamic Widget creation from static memory pool&nbsp;</div></td><td class="Element67" valign="top" width="41%">
<div class="Element68">
Widgets are transient. They are created and deleted as new screens are rendered.&nbsp;</div></td></tr></table></div></div>
</div>
</div>
<a name="546F70696373"></a><div class="Element14">
Topics</div>
<div class="Element11">
<div class="Element10">
<div class="Element212">
<div class="TableDiv">
<table cellspacing="0" class="Table1">
<tr>
<td class="Element200" valign="top" width="35%">
<div class="Element201">
Name&nbsp;</div></td><td class="Element204" valign="top" width="65%">
<div class="Element205">
Description&nbsp;</div></td></tr><tr>
<td class="Element202" valign="top" width="35%">
<div class="Element203">
<a href="02799.html" target="topic">Porting aria_quickstart_mzef_cu_wqvga to legato</a>&nbsp;</div></td><td class="Element206" valign="top" width="65%">
<div class="Element207">
Legato graphics library of the MPLAB Harmony Graphics Suite brings in some changes to the way applications are developed. This topic is ports an Aria quickstart application Legato.<br><br>For step-by-step instructions on porting applications from Aria to Legato, refer to <a href="#" onclick="openExternalLink('https://github.com/Microchip-MPLAB-Harmony/gfx/wiki/Porting-aria-quickstart_mzef_cu_wqvga-to-Legato');"><img src="indicator_external_link.gif" border="0" alt="" title="">Porting aria_quickstart_mzef_cu_wqvga to Legato</a>&nbsp;</div></td></tr></table></div></div>
</div>
</div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00462.html" target="topic">MPLAB® Harmony Graphics Suite</a> &gt; <a href="02750.html" target="topic">Advanced Topics</a> &gt; <a href="02798.html" target="topic">Porting Aria Applications to Legato</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element3">
MPLAB® Harmony Graphics Suite</div>
</td><td width="25%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00462.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element91">
<a href="02762.html" target="topic">Previous</a> | <a href="02750.html" target="topic">Up</a> | <a href="02799.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: Porting Aria Applications to Legato Topic Title: Porting Aria Applications to Legato)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>